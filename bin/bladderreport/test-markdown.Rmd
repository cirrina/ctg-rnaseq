---
title: 'bladderreport-ctg-1.1.0'
params:
  clarity_id: R09_T1
  rsem_in: ./uroscan_data/R09_T1.rsem
  sampleid: R09_T1_rsem
  star_qc: ./uroscan_data/R09_T1_Log.final.out
  anonymous: yes
  RIN: 9.5
  concentration: 130.4
  date: 2021-09-14

output:
  html_document:
    highlight: tango
  pdf_document: default
---


<style type="text/css">

body, td {
font-size: 14px;
}
code.r{
font-size: 18px;
}
pre {
font-size: 14px
}
</style>



```{r debug,  eval=FALSE, include=FALSE}
## DEBUG ONLY
params <- list(
  clarity_id="R09_T1"
)

```




```{r setup, include=FALSE}

.libPaths('')

# .libPaths( c( "/home/petter/R/x86_64-pc-linux-gnu-library/3.4") )

library("ggplot2")
library("cowplot")
library("reshape")
# library("knitr", lib ="/home/petter/R/x86_64-pc-linux-gnu-library/3.4")
# library("kableExtra", lib ="/home/petter/R/x86_64-pc-linux-gnu-library/3.4")
# library("dplyr",, lib ="/home/petter/R/x86_64-pc-linux-gnu-library/3.4")
library("knitr")
library("dplyr")
library("kableExtra")
library("ranger")
library("jsonlite")
library("gridExtra")


options(digits=2)
options(stringsAsFactors = F)

colorPal <- c("#7BC0F7", "#3B8AD9", "#F18226", "#FFDB69", "#61737B", "#A6B3B3", "#E24B26")

knitr::opts_chunk$set(echo = TRUE)


###
# Functions Nour/Pontus
# ###
# load("./scripts/classifiers_LundClassifier2018.Rdata")
# source("./scripts/functions_LundClassifier2018.r")

###
# </Functions Nour>
###


# Example data
#rsem_file <- "/data/bnf/premap/rnaseq/18KFU0001_0.rsem"
#clarity_id <- "ALL354A1"

###
# read the GEX data for one sample
###
#
# rsem_file <- params$rsem_in
#
# if (!file.exists(rsem_file)){
#   quit("In file not found")
# }
#
#
# rsem <- read.table(rsem_file, header = T, row.names = 1)
# sample <- rsem$TPM
# symbol <- sapply(strsplit(rownames(rsem),"_"), "[[", 2)
#
# symbol <- gsub("-","_",symbol)
# names(sample)<-symbol
# sample <- as.matrix(sample)
#
# #######################################################
# # Extract patient and sample information from clarity if on region skåne server
# #######################################################
#
# clarity_id<-params$clarity_id

sampledata<-data.frame(
  patientnamn="Ej tillgänglig",
  personnummer = "Ej tillgänglig",
  ankomstdatum = "Ej tillgänglig",
  koncentration = "Ej tillgänglig",
  dv200 = "Ej tillgänglig",
  RIN = "Ej tillgänglig")



```


## Analysrapport inom ramen för forskningsstudien UROSCANSEQ - Expressionsdriven klassificering av blåscancer



***

### Slutsats

RNA-kvalitet: <b>godkänd</b>

```{r, results_classifier, include=T, echo=F}

plot(1:10, 1:10, ylab=sampledata$patientnamn, xlab="värde")
```



### Analysbeskrivning

RNA har extraherats från insänt prov (tumörbiopsi från TURB) och analyserats med massivt parallell sekvensering (MPS, även kallat NGS). budbärar-RNA selekterades från 200 ng total-ribonukleinsyror med hjälp av polyA-rening, fragmenterades och amplifierades med slumpmässiga startmolekyler med hjälp av "TruSeq Stranded mRNA"-kittet från Illumina. Efter DNA-ändsreparation, cDNA-syntes och ligering av sekvenseringsadaptorer sekvenserades provet på en NextSeq 500 med en läslängd av 2 x 150.

Resulterande läsningar sekvensinpassades (STAR) samt kvantifierades (RSEM) mot det human genomet version b37. För klassificering används en ensemblklassificareare med en "top scoring pair classifier"-del och en "random forest"-del implementerad i R och utvecklad och tränad av Mattias Höglund med kollegor.

### Referenser
* Li et al 2013: https://arxiv.org/abs/1303.3997
* A framework for variation discovery and genotyping using next-generation DNA sequencing dataDePristo M, Banks E, Poplin R, Garimella K, Maguire J, Hartl C, Philippakis A, del Angel G, Rivas MA, Hanna M, McKenna A, Fennell T, Kernytsky A, Sivachenko A, Cibulskis K, Gabriel S, Altshuler D, Daly M, 2011 NATURE GENETICS 43:491-498
* From FastQ Data to High-Confidence Variant Calls: The Genome Analysis Toolkit Best Practices Pipeline Van der Auwera GA, Carneiro M, Hartl C, Poplin R, del Angel G, Levy-Moonshine A, Jordan T, Shakir K, Roazen D, Thibault J, Banks E, Garimella K, Altshuler D, Gabriel S, DePristo M, 2013 CURRENT PROTOCOLS IN BIOINFORMATICS 43:11.10.1-11.10.33
